#RegionServer Sizing Rules of Thumb
ars Hofhansl wrote a great blog post about RegionServer memory sizing. 结果是你可能需要比你认为的更多的内存。它受到region size、memstoresize、Hdfs replication factor，以及其他要检查的事项的影响。

>  Personally I would place the maximum disk space per machine that can be served exclusively with HBase around 6T, unless you have a very read-heavy workload. In that case the Java heap should be 32GB (20G regions, 128M memstores, the rest defaults).

>   — Lars Hofhansl

>   http://hadoop-hbase.blogspot.com/2013/01/hbase-region-server-memory-sizing.html

##35. 根据列族数量
当前Hbase在处理2或3个以上列族时，表现不是很好，所以控制你schema中的列族数尽量少点。目前flush和compaction是在每个region的基础上进行。所以当一个列族操作大量数据时会引发flush，而相连的列族也会进行flush，即使它们操作的数据量很少。当许多列族存在flush和compaction相互作用时，会产生大量不必要的i/o（这个通过使flush和compaction只针对一个列族来解决）

尽量在你的schema中使用一个列族。只有数据访问固定在特定的列时，可以引入第二个和第三个列族.例如，你有两个列族,但你查询的时候总是访问其中的一个，从来不会两个一起访问。

###35.1. 列族的基数
当表中存在多个列在时，注意表的基数（行的数量）。如果ColumnfamliyA有100万行，而ColumnFamilyB有10亿行，CFA的数据可能分散在许多regions中（及RS中），这将导致CFA的scans操作非常低效。

##36. 行键设计
###36.1. Hotspotting
Hbase中行是按行键的字典序列排序的。这种设计优化scans操作，让你可以将相关的行存储在一起，或靠近的行将一起被读取。当然，row keys设计不好是hotspotting一个常见的原由。hotspotting发生在当大量客户流量流向一个节点或一些节点或一个集群时。这个流量可代表读、写或其他操作。它可能会淹没负责管理这个region的单台机器，导致其性能下降及导致region不可用。也可能会对同一region server管理的其他region产生不好的影响，如不能服务所需的负载。要想集群被充分使用，设计数据访问模式很重要。

避免写操作时的hotspotting，把row key设计成这样：行确实是需要在同一个region。但in the bigger picture，数据会被写倍集群中多个region，而不是一次一个。下面会描述一些常见的避免hotspotting技术，以及它们的优缺点。

